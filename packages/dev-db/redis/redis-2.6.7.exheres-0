# Copyright 2012 Marc-Antoine Perennou <Marc-Antoine@Perennou.com>
# Distributed under the terms of the GNU General Public License v2
# Copyright 2012 Marc-Antoine Perennou <Marc-Antoine@Perennou.com>
# Distributed under the terms of the GNU General Public License v2

require googlecode [ suffix=tar.gz ]

SUMMARY="Open source in-memory key-value store"
DESCRIPTION="
Redis is an open source, advanced key-value store. It is often referred to as a data structure
server since keys can contain strings, hashes, lists, sets and sorted sets.
"

LICENCES="redis"
SLOT="0"
PLATFORMS="~amd64"
MYOPTIONS=""

DEPENDENCIES=""

#DEFAULT_SRC_CONFIGURE_PARAMS=( )
#DEFAULT_SRC_CONFIGURE_OPTION_WITHS=( )
#DEFAULT_SRC_CONFIGURE_OPTION_ENABLES=( )

src_test() {
    esandbox allow_net --connect inet:127.0.0.1@11111
    esandbox allow_net inet:0.0.0.0@11111
    esandbox allow_net --connect inet:127.0.0.1@20000-30000
    esandbox allow_net inet:0.0.0.0@20000-30000

    emake test

    esandbox disallow_net --connect inet:127.0.0.1@11111
    esandbox disallow_net inet:0.0.0.0@11111
    esandbox disallow_net --connect inet:127.0.0.1@20000-30000
    esandbox disallow_net inet:0.0.0.0@20000-30000
}

src_install() {
    emake PREFIX=${IMAGE} install
}
