# Copyright 2020 Maxime Sorin <maxime.sorin@clever-cloud.com>
# Distributed under the terms of the GNU General Public License v2

PLATFORMS="~amd64"

runtime="${PV%.*}.10"
bootstrap="3.1.109"

src_prepare() {
    default 

    export CC="$(exhost --tool-prefix)clang"
    export CXX="$(exhost --tool-prefix)clang++"

    # dotnet/coreclr repository
    edo cp "${FILES}"/${SLOT}/0101-CORECLR-banned-by-distribution.patch "${WORK}"/patches/coreclr
    edo cp "${FILES}"/${SLOT}/0102-CORECLR-undeclared-identifier-DAC_TABLE_RVA.patch "${WORK}"/patches/coreclr

    # dotnet/corefx repository
    edo cp "${FILES}"/${SLOT}/0103-COREFX-banned-by-distribution.patch "${WORK}"/patches/corefx

    # dotnet/coresetup repository
    edo cp "${FILES}"/${SLOT}/0104-CORESETUP-banned-by-distribution.patch "${WORK}"/patches/core-setup
    edo cp "${FILES}"/${SLOT}/0105-CORESETUP-fix-corehost-rid.patch "${WORK}"/patches/core-setup
}

require dotnet-sdk

