# Minimal AIDE configuration for Exherbo
# See aide.conf(5) for details

# Database locations
@@define DBDIR /var/lib/aide
@@define LOGDIR /var/log/aide

database_in=file:@@{DBDIR}/aide.db.gz
database_out=file:@@{DBDIR}/aide.db.new.gz

# Gzip database for space efficiency
gzip_dbout=yes

# Logging
log_level=warning
report_url=file:@@{LOGDIR}/aide.log
report_url=stdout

# Basic rule definitions
# Core attributes: permissions, inode, links, user, group, size, mtime, checksum
NORMAL = p+i+n+u+g+s+m+c+sha256

# For directories (no checksum needed)
DIR = p+i+n+u+g

# For configuration files (extra security)
CONFIG = p+i+n+u+g+s+m+c+sha256+sha512

# Essential system paths to monitor
/etc DIR
/etc/passwd CONFIG
/etc/group CONFIG
/etc/shadow CONFIG
/etc/sudoers CONFIG
/etc/ssh CONFIG

/bin NORMAL
/sbin NORMAL
/usr/bin NORMAL
/usr/sbin NORMAL

/lib NORMAL
/lib64 NORMAL
/usr/lib NORMAL
/usr/lib64 NORMAL

/boot NORMAL

# Exclude volatile directories
!/var/cache
!/var/log
!/var/run
!/var/tmp
!/tmp
!/proc
!/sys
!/dev
