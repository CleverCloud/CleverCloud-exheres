From 823ae213c93567d8c81bb61221b173cb086beee8 Mon Sep 17 00:00:00 2001
From: David Legrand <1110600+davlgd@users.noreply.github.com>
Date: Mon, 25 Mar 2024 08:52:48 +0100
Subject: [PATCH] vbuild-tools: prevent module update for packaging
Upstream: Yes (#21094)
---
 cmd/tools/vbuild-tools.v | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/cmd/tools/vbuild-tools.v b/cmd/tools/vbuild-tools.v
index a417cd3c1c4b0c..a88ccb823d12cc 100644
--- a/cmd/tools/vbuild-tools.v
+++ b/cmd/tools/vbuild-tools.v
@@ -19,7 +19,9 @@ const tools_in_subfolders = ['vast', 'vcreate', 'vdoc', 'vpm', 'vvet', 'vwhere']
 const non_packaged_tools = ['gen1m', 'gen_vc', 'fast', 'wyhash']
 
 fn main() {
-	util.ensure_modules_for_all_tools_are_installed('-v' in os.args)
+	if os.getenv('VTEST_SANDBOXED_PACKAGING') == '' {
+		util.ensure_modules_for_all_tools_are_installed('-v' in os.args)
+	}
 	args_string := os.args[1..].join(' ')
 	vexe := os.getenv('VEXE')
 	vroot := os.dir(vexe)
